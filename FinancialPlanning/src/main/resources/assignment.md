# Financial Planning assignment

All the code for this assignment can be found in `FinancialPlanning/src/main/java/com/ortecfinance/financialplanning/` we will continue to build on the `Java` code in there. Background information for Amazon Alexa skills can be found here:

```
FinancialPlanning/src/main/resources/alexa-reference.md
``` 

## Project structure

A brief description of the project structure

### Source code

All the source code is in:

```
FinancialPlanning/src/main/java/com/ortecfinance/financialplanning/
```

### Tests

All the unit tests are in:

```
FinancialPlanning/src/main/test/java/com/ortecfinance/financialplanning/3
```

_Hint: certain tests are ignored, they can safely be ignored for the first assignment but for the extra assignments they may prove useful. You can run them by removing the `@Ignore` annotation._

### Request flow:

1. The request will enter in the `FinancialPlanningSpeechlet` in the `onIntent(..)` method
2. The response will be generated by the `ResponseTextFactory` class
    1. It will store any user answers in the `Session` to remember them in the session
    2. It will then use the `NextQuestionFactory` to determine what question to ask next
3. The `EndSessionFactory` determines whether the conversation has finished (in which case the session should be ended)
4. The response is transformed to an object the Alexa API understands in the `ResponseFactory`

_Hint: All classes mentioned after step 1 will have to be updated when adding a new intent._

### Administrative parts

* The `AmazonIntents` includes all the intents defined by Amazon that we have to handle
* The `FinancialPlanningIntents` includes all our own intents that we have to handle
* The `intents.json` includes the model of the skill, including what the user has to say for Alexa to understand

_Hint: You do not have to update the `intents.json` unless you add your own ideas to the skill, at the start feel free to leave the `intents.json` as is._

### Calculation / modeling part

The very basic calculation / simulation is done in the `FeasibilityCalculator`, it is up to you to determine if you want to improve it or leave it as is.

## Improve a basic financial planner 

A basic financial planner has been implemented and is running on your Echo. It performs the following actions:

- Introduction to the app when you say "Alexa start _ECHO_NAME_ON_STICKER_"
- Alexa then asks you for your target amount
- Answer an amount (see `FinancialPlanning/src/main/resources/intents.json` for sample phrases)
- Alexa then asks you for your monthly deposit
- Answer an amount
- Alexa then asks you for your time to target (number of months)
- Answer an amount 
- Alexa provides a feasibility of High

You are going to expand the code to be able to ask for an initial amount, after that expansion the basic conversation of a financial planner is ready.

### Adding the `SetInitialSavingsIntent`

First look at the intents.json:

```
FinancialPlanning/src/main/resources/intents.json
```

We have already added the intent to the JSON but the intent below it is not yet handled by the `Speechlet`:

```
{
  "name": "SetInitialSavingsIntent",
  "slots": [
    {
      "name": "InitialSavings",
      "type": "AMAZON.NUMBER"
    }
  ],
  "samples": [
    "my initial savings are {InitialSavings}",
    "savings are {InitialSavings}",
    "my current savings are {InitialSavings}"
  ]
}
```

We have to add the code to handle this `SetInitialSavings` intent.

#### Verify the current code can be build
First verify that the code compiles and all tests are working by running: 
   
``` 
mvn clean install
``` 

#### Adding intent

Add an intent to `FinancialPlanningIntents` with the value `SetInitialSavingsIntent`.

#### Add a question

Next add a question to the `FinancialPlanningSpeechlet`: "How much have you currently saved?". Also add a key here with the value `InitialSavings`.

#### Update the code that handles the question and response

Now update the following files: `EndSessionFactory`, `NextQuestionFactory` and `ResponseTextFactory` 
with the newly created constants. The new functionality should be very similar to the goal amount functionality.  

#### Add unit tests that verify the updated code

Now expand the test in line with your new code: `EndSessionFactoryTest`, `NextQuestionFactoryTest` 
and `ResponseTextFactoryTest`.

Run the tests again:

``` 
mvn clean install
```

#### Build the skill with updated code

If compilation and tests are successful, run the following command:

```
mvn assembly:assembly -DdescriptorId=jar-with-dependencies package
```

#### Deploy & Test

Now it is time to upload your code and see if it works!
Contact a member of the team to deploy the solution.   


## Extra additions

Since you have a basic working solution now, here are several ideas on how to improve the current skill you have. You can do them in any order.

### Extra: Better UX through dynamic numbers
Enable Alexa to understand it if you only provide a number for each question instead of full utterances. See the ignored test in `FinancialPlanningSpeechletTest` for an example conversation your skill would have to handle. Once this is done users can simply answer in only numbers, instead of constantly uttering the full phrases.

Example conversation:

```
Alexa: What is the amount you need to achieve your financial goal?
User: 20 000
Alexa: What will your monthly contribution be? 
User: 200
Alexa: How many months are left until the goal is achieved?
User: 68
```
_Note: in this approach all numbers uttered by the user map to the `SET_DYNAMIC_NUMBER_INTENT`, you will have to figure out a way to decide what question the user answered, it could be any of the four questions._

_Hint: take a look at the `DynamicNumberKeyFactory`, it includes a crucial part of the puzzle._

_Starting point: in the first assignment the `SetInitialSavingsIntent` was added and handled, in this assignment you will have to start handling the `SetDynamicNumberIntent`. Start by adding the `SetDynamicNumberIntent` in all the different places you added the 'SetInitialSavingsIntent'._

### Extra: Better feasibility calculation

Alexa can only give two verdicts: High and Low. The answer is based on whether the expected end result (based on a 2.75% average return) is higher or lower than the target.

Extend the range of possible answers to four by also comparing with 1.5% and a 3.75% scenario.

_Note: Update the `FeasibilityCalculator` class with extra logic. You also need to update the unit tests in the `FeasibilityCalculatorTest` class._

### Extra: Advanced financial planning conversation

Instead of stopping after the calculation, add the option to fix a low feasibility. Use three possible options to make the goal feasible:
 
* Lower the goal 
* Increase the monthly deposit
* Increase the time to target (a longer period should yield a higher feasibility) 

_Note: you will need to add your own intents here, update the `intents.json` and the `Java` code to handle the extra intents. We can deploy the `intents.json` and `.jar` file for you once you are ready._

_Starting point: in the first assignment the `SetInitialSavingsIntent` was added and handled, in this extra assignment you will essentially have to repeat the process with the intents listed above._

### Extra: Your own idea

Feel free to improve on the current skill with your own idea's, the goal is to create a skill that helps people achieve their financial goals, in this extra you get total freedom to achieve that goal.

_Note: you will need to add your own intents here, update the `intents.json` and the `Java` code to handle the extra intents. We can deploy the `intents.json` and `.jar` file for you once you are ready._ 

#### Example extra intent:

Below is an example of an added Intent called `YourExtraIntent` in the `intents.json`:

``` 
{
  "interactionModel": {
    "languageModel": {
      "invocationName": "financial planning",
      "intents": [
        {
          "name": "FinancialPlanningIntent",
          "slots": [],
          "samples": [
            "help me achieve my financial goals",
            "help achieve goals",
            "financial goals"
          ]
        },
        ...
        {
          "name": "YourExtraIntent",
          "slots": [],
          "samples": [
            "Here is my extra intent",
            "Use my extra intent",
            "Please perform my extra intent"
          ]          
        }
      ],
      "types": []
    }
  }
}
```

If you want your skill to handle extra phrases, any phrases, you will also need to modify the `intents.json` with your extra intent.

The file can be found here:

```
./FinancialPlaning/src/main/resources/speechassets/intents.json
```